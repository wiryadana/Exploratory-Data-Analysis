---
title: "College Costs"
author: "Eric Fletcher"
date: "7/30/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Import Data}
#Pulling data from https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-03-10/readme.md

tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')

tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 

salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')

historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')

diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv')
```
```{r Import Libraries}
library(tidyverse)
library(scales)
theme_set(theme_light()) #my default theme inspired by the talented David Robinson (https://www.youtube.com/channel/UCeiiqmVK07qhY-wvg3IZiZQ)
```

```{r Raw Data Inspection / Manipulations}
#tuition_cost seems like a good start.
options(scipen = 999)

glimpse(tuition_cost) #2,973 rows & 10 columns
summary(tuition_cost) #large range between the lowest and highest costs

tuition_cost_clean <- tuition_cost %>% 
  rename(state_abbr = state_code) #rename the state_code column to state_abbr
```

```{r NA Counts}
##NA counts

#tidyverse approach
na_count <- tuition_cost_clean %>% 
  summarise_all(~ sum(is.na(.)/nrow(tuition_cost_clean)))
#room_and_board has 1,094 NA's, or 0.367% - enough NA's to not prioritize in this analysis
#state has 52 NA's, or 0.017% - not a big deal

#base approach 
na_counts <- sapply(tuition_cost_clean, function(x) sum(length(which(is.na(x))))/nrow(tuition_cost_clean))
```

```{r EDA Tuition Cost}
colnames(tuition_cost_clean)
# [1] "name"                 "state"                "state_abbr"           "type"                 "degree_length"       
# [6] "room_and_board"       "in_state_tuition"     "in_state_total"       "out_of_state_tuition" "out_of_state_total" 

##Look at the distributions

#in_state_total
tuition_cost_clean %>% 
  ggplot(aes(in_state_total)) +
  geom_histogram(bins = 100) +
  scale_x_continuous(labels = scales::comma) #majority of tuition is between $0 and $20,000

#out-of-state-total
tuition_cost_clean %>% 
  ggplot(aes(out_of_state_total)) +
  geom_histogram(bins = 100) +
  scale_x_continuous(labels = scales::comma) #majority of tuition is between $0 and $20,000

##Continue EDA with counts to get the mode of the various data features. 

tuition_cost_clean %>% 
  count(state, sort = TRUE)
#California has the most recorded observations

tuition_cost_clean %>% 
  count(state) %>% 
  arrange(n)
#Alaska, Wyoming, and Delaware has the least amount of recorded observations.   

tuition_cost_clean %>% 
  mutate(name = reorder(name, in_state_total)) %>% 
  filter(degree_length == "4 Year") %>% 
  top_n(20) %>% 
  arrange(desc(in_state_total)) %>% 
  ggplot(aes(x = name, y = in_state_total))+
  geom_point() + 
  geom_segment(aes(x = name, xend = name, y = 0, yend = in_state_total))+
  coord_flip()+
  scale_y_continuous(labels = scales::"comma")+
  labs(title = "2018-2019: Most Expensive 4-Year Colleges",
       subtitle = "In-State Total (sum of room & board + tuition)",
       x = "",
       y = "Cost (USD)")
  
```

